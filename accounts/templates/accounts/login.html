{% extends 'base.html' %}
{% load django_bootstrap5 %}
{% load static %}
{% block css %}
  <link rel="stylesheet" href="{% static 'accounts/css/login.css' %}">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/xeicon@2.3.3/xeicon.min.css">
{% endblock css %}

{% block content %}
  <!--로그인 폼-->
  <section>
    <div class="color"></div>
    <div class="color"></div>
    <div class="color"></div>
    <div class="box">
      <div class="square" style="--i:0;"></div>
      <div class="square" style="--i:1;"></div>
      <div class="square" style="--i:2;"></div>
      <div class="square" style="--i:3;"></div>
      <div class="square" style="--i:4;"></div>
      <div class="container">
        <div class="form">
          <h2>로그인</h2>
          <form action="{% url 'accounts:login' %}" method="POST" >
              {% csrf_token %}
            <div class="d-flex justify-content-center">
              <div class="inputBox">
                {{ form.username }}
                {% comment %} <input type="text" placeholder="아이디"> {% endcomment %}
              </div>
            </div>
            <div class="d-flex justify-content-center">
              <div class="inputBox">
                {{ form.password }}
                {% comment %} <input type="password" placeholder="비밀번호"> {% endcomment %}
              </div>
            </div>
            <div class="d-flex justify-content-center">
              <div class="inputBox">
                <input type="submit" value="로그인">
              </div>
            </div>
            <p class="forget">비밀번호를 잊어버리셨나요?<a href="#" class="ms-2">여기 누르세요</a>
            </p>
            <p class="forget">계정이 없으신가요?<a href="#" class="ms-2">회원가입</a>
            </p>
            <hr>
            <div class="d-flex justify-content-center">
              <p class="">간편로그인</p>
            </div>
            <div class="d-flex justify-content-center"> 
              <button type="button" class="btn mx-1 fs-4 p-0 border-0">
                <img src="{% static 'images/카톡.png'%}" style="width:40px; height:40px;" onclick="kakaoLogin();" >
                <a href="javascript:void(0)">
                </a>
              </button>
              <button type="button" class="btn mx-1 fs-4 p-0 border-0">
                <img src="{% static 'images/구글로긴.png'%}" style="width:48px; height:48px;">
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </section>

  <!-- 구글 로그인 {% load socialaccount %} {% providers_media_js %} <h1>인터넷응용 2020</h1> <a href="/accounts/signup">회원가입</a> {% if user.is_authenticated %} <a href="/accounts/logout">로그아웃</a> {{user.username}} 님이 로그인 중 {% else %} <a href="{% provider_login_url 'google' %}">구글 로그인</a><br> 로그인 하세유 {% endif %} <div class="col-md-6"> <a href="{% provider_login_url 'kakao' %}" class="btn btn-outline-dark btn-block btn-sm" role="button">Log In With kakao</a> </div> -->
  
{% endblock content %}
{% block js %}

  <ul>
    <li onclick="kakaoLogin();">
      <a href="javascript:void(0)">
        <span>카카오 로그인</span>
      </a>
    </li>
    <li onclick="kakaoLogout();">
      <a href="javascript:void(0)">
        <span>카카오 로그아웃</span>
      </a>
    </li>
  </ul>
  <!-- 카카오 스크립트 -->
  <script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
  <script>
    Kakao.init('859aceb90553e35aea74a737254f983c'); //발급받은 키 중 javascript키를 사용해준다.
    console.log(Kakao.isInitialized()); // sdk초기화여부판단
    //카카오로그인
    function kakaoLogin() {
      Kakao
        .Auth
        .login({
          success: function (response) {
            Kakao
              .API
              .request({
                url: '/v2/user/me',
                success: function (response) {
                  console.log(response)
                },
                fail: function (error) {
                  console.log(error)
                }
              })
          },
          fail: function (error) {
            console.log(error)
          }
        })
    }
    //카카오로그아웃
    function kakaoLogout() {
      if (Kakao.Auth.getAccessToken()) {
        Kakao
          .API
          .request({
            url: '/v1/user/unlink',
            success: function (response) {
              console.log(response)
            },
            fail: function (error) {
              console.log(error)
            }
          })
        Kakao
          .Auth
          .setAccessToken(undefined)
      }
    }
  </script>

{% endblock js %}